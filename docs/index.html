<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Test Runner</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Vue App Container -->
    <div id="app" v-cloak>
        <div class="container">
            <header>
                <h1>üöÄ Performance Test Runner</h1>
                <p class="subtitle">Configure and trigger performance tests</p>
                <p class="version">{{ version }}</p>
            </header>

            <main>
                <!-- Configuration Form -->
                <section class="config-section">
                    <h2>Test Configuration</h2>
                    
                    <form @submit.prevent="handleSubmit">
                        <!-- Target URL -->
                        <div class="form-group">
                            <label for="target-url">
                                Target URL <span class="required">*</span>
                            </label>
                            <input 
                                type="url" 
                                id="target-url"
                                v-model="form.targetUrl"
                                placeholder="https://api.example.com/endpoint"
                                required
                            >
                            <small>The URL endpoint to test</small>
                        </div>

                        <!-- Duration and Users -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="duration">
                                    Duration (seconds) <span class="required">*</span>
                                </label>
                                <input 
                                    type="number" 
                                    id="duration"
                                    v-model.number="form.duration"
                                    min="1"
                                    max="3600"
                                    required
                                >
                                <small>How long to run the test</small>
                            </div>

                            <div class="form-group">
                                <label for="users">
                                    Virtual Users <span class="required">*</span>
                                </label>
                                <input 
                                    type="number" 
                                    id="users"
                                    v-model.number="form.users"
                                    min="1"
                                    max="1000"
                                    required
                                >
                                <small>Concurrent users to simulate</small>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <button 
                            type="submit" 
                            class="btn btn-primary" 
                            :disabled="isSubmitting"
                        >
                            <span v-if="!isSubmitting">‚ñ∂Ô∏è Run Performance Test</span>
                            <span v-else>‚è≥ Triggering...</span>
                        </button>
                    </form>
                </section>

                <!-- JSON Output -->
                <section class="output-section">
                    <h2>Generated Configuration</h2>
                    <div class="json-container">
                        <pre id="json-output" class="json-output">{{ formattedConfig }}</pre>
                        <button 
                            type="button" 
                            class="btn-icon" 
                            @click="copyJSON"
                            title="Copy JSON"
                        >
                            {{ copyButtonText }}
                        </button>
                    </div>
                </section>

                <!-- Status Section -->
                <section class="status-section" v-if="status.visible">
                    <h2>Status</h2>
                    <div 
                        class="status-content" 
                        :class="'status-' + status.type"
                        v-html="status.message"
                    ></div>
                </section>
            </main>

            <footer>
                <p>
                    Powered by GitHub Actions | 
                    <a :href="'https://github.com/' + config.REPO_OWNER + '/perf-runner-ui'" 
                       target="_blank" 
                       rel="noopener">
                        View Source
                    </a>
                </p>
            </footer>
        </div>

        <!-- Token Modal -->
        <div class="modal" v-if="modal.visible" @click.self="closeModal">
            <div class="modal-content">
                <h3>‚ö†Ô∏è GitHub Token Required</h3>
                <p>To trigger GitHub Actions, you need to provide a Personal Access Token.</p>
                
                <div class="form-group">
                    <label for="github-token">GitHub Personal Access Token</label>
                    <input 
                        type="password" 
                        id="github-token"
                        v-model="modal.tokenInput"
                        @keyup.enter="saveToken"
                        placeholder="ghp_xxxxxxxxxxxx"
                    >
                    <small>
                        <a href="https://github.com/settings/tokens/new?scopes=repo,workflow&description=Perf%20Test%20Runner" 
                           target="_blank" 
                           rel="noopener">
                            Generate token
                        </a> with <code>repo</code> and <code>workflow</code> scopes
                    </small>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" @click="closeModal">
                        Cancel
                    </button>
                    <button type="button" class="btn btn-primary" @click="saveToken">
                        Save Token
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Vue.js 3 from CDN -->
    <script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js"></script>
    
    <!-- Configuration -->
    <script src="js/config.js"></script>
    
    <!-- Vue Application -->
    <script src="js/app.js"></script>
</body>
</html>